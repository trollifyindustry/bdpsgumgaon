<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Info</title>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
  body { font-family:'Poppins', sans-serif; background:#f0f2f5; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
  .card { background:white; padding:30px; border-radius:15px; max-width:500px; width:90%; box-shadow:0 10px 25px rgba(0,0,0,0.1); text-align:center; }
  .photo { width:150px; height:150px; border-radius:50%; object-fit:cover; border:3px solid #007bff; margin-bottom:20px; }
  .info-row { margin:10px 0; font-size:16px; }
  .info-row span { font-weight:600; color:#555; }
  .phone-link { color:#007bff; text-decoration:none; margin:0 5px; }
  .phone-link:hover { text-decoration:underline; }
</style>
</head>
<body>

<div class="card" id="studentCard" style="display:none;">
  <img id="photo" class="photo" src="" alt="Student Photo"/>
  <h2 id="name"></h2>
  <div class="info-row"><span>Scholar No:</span> <span id="scholarNo"></span></div>
  <div class="info-row"><span>Father:</span> <span id="father"></span></div>
  <div class="info-row"><span>Class:</span> <span id="class"></span></div>
  <div class="info-row"><span>BOB:</span> <span id="bob"></span></div>
  <div class="info-row"><span>Gender:</span> <span id="gender"></span></div>
  <div class="info-row"><span>Address:</span> <span id="address"></span></div>
  <div class="info-row"><span>Phone:</span>
    <a id="phone1" class="phone-link"></a>
    <a id="phone2" class="phone-link"></a>
  </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbyktAwPJZoi-PERUJX9-upxODbx_sSM7x7W2iLbfHXF7z8mfanqXFXAwmLtsj-NjQ5j2g/exec";

function showSpinner(){
  Swal.fire({title:'Loading...', allowOutsideClick:false, didOpen:()=>Swal.showLoading()});
}
function hideSpinner(){ Swal.close(); }

async function fetchStudent(id){
  showSpinner();
  try{
    const res = await fetch(scriptURL+"?id="+id);
    const data = await res.json();
    hideSpinner();
    if(data.error){ Swal.fire('Error',data.error,'error'); return; }

    document.getElementById("scholarNo").innerText = data["Scholar No"] || "";
    document.getElementById("name").innerText = data["student Name"] || "";
    document.getElementById("father").innerText = data["Father"] || "";
    document.getElementById("class").innerText = data["Class"] || "";
    document.getElementById("bob").innerText = data["BOB"] || "";
    document.getElementById("gender").innerText = data["Gender"] || "";
    document.getElementById("address").innerText = data["Address"] || "";
    document.getElementById("photo").src = data["PhotoURL"] || "";
    document.getElementById("phone1").innerText = data["Phone1"] || "";
    document.getElementById("phone1").href = "tel:"+data["Phone1"];
    document.getElementById("phone2").innerText = data["Phone2"] || "";
    document.getElementById("phone2").href = "tel:"+data["Phone2"];
    document.getElementById("studentCard").style.display="block";

  }catch(err){ hideSpinner(); Swal.fire('Error','Failed to fetch data','error'); console.error(err);}
}

// Auto fetch from URL
window.onload = function(){
  const urlParams = new URLSearchParams(window.location.search);
  const idParam = urlParams.get('id');
  if(idParam && idParam.length>=3) fetchStudent(idParam);
}
</script>

</body>
</html>
