<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Info</title>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Poppins', sans-serif; background: #f0f2f5; margin:0; padding:0; display:flex; justify-content:center; align-items:center; min-height:100vh; }
  .card { background: #fff; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 500px; width: 90%; padding: 30px; text-align:center; transition: transform 0.3s; }
  .card:hover { transform: translateY(-5px); }
  .photo { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin-bottom: 20px; border: 4px solid #007bff; }
  h2 { margin-bottom: 20px; color: #333; }
  .info-row { margin-bottom: 12px; font-size: 16px; }
  .info-row span { font-weight: 600; color: #555; }
  .phone-link { color: #007bff; text-decoration: none; font-weight: 500; margin:0 5px; }
  .phone-link:hover { text-decoration: underline; }
</style>
</head>
<body>
<div class="card" id="studentCard" style="display:none;">
  <img id="photo" class="photo" src="" alt="Student Photo"/>
  <h2 id="name"></h2>
  <div class="info-row"><span>Scholar No:</span> <span id="scholarNo"></span></div>
  <div class="info-row"><span>Father:</span> <span id="father"></span></div>
  <div class="info-row"><span>Class:</span> <span id="class"></span></div>
  <div class="info-row"><span>BOB:</span> <span id="bob"></span></div>
  <div class="info-row"><span>Gender:</span> <span id="gender"></span></div>
  <div class="info-row"><span>Address:</span> <span id="address"></span></div>
  <div class="info-row"><span>Phone:</span> 
    <a id="phone1" class="phone-link"></a>
    <a id="phone2" class="phone-link"></a>
  </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbyNszqJIAMuwAf4Zz2pXDYxeHjRvq2-C2qbEzu9pPaVNQ6T4RFIM1kbgnJRFUIzRxVwPw/exec"; // Replace with your Apps Script URL

function showSpinner() {
  Swal.fire({
    title: 'Loading...',
    allowOutsideClick: false,
    didOpen: () => Swal.showLoading()
  });
}

function hideSpinner() {
  Swal.close();
}

async function fetchStudent(id) {
  showSpinner();
  try {
    const response = await fetch(scriptURL + "?id=" + id);
    const data = await response.json();
    hideSpinner();
    if(data.error){
      Swal.fire('Error', data.error, 'error');
      return;
    }

    document.getElementById("scholarNo").innerText = data["Scholar No"] || "";
    document.getElementById("name").innerText = data["student Name"] || "";
    document.getElementById("father").innerText = data["father"] || "";
    document.getElementById("class").innerText = data["Class"] || "";
    document.getElementById("bob").innerText = data["BOB"] || "";
    document.getElementById("gender").innerText = data["Gender"] || "";
    document.getElementById("address").innerText = data["Address"] || "";
    document.getElementById("photo").src = data["PhotoURL"] || "";
    document.getElementById("phone1").innerText = data["Phone1"] || "";
    document.getElementById("phone1").href = "tel:" + data["Phone1"];
    document.getElementById("phone2").innerText = data["Phone2"] || "";
    document.getElementById("phone2").href = "tel:" + data["Phone2"];

    document.getElementById("studentCard").style.display = "block";

  } catch(err) {
    hideSpinner();
    Swal.fire('Error', 'Failed to fetch data', 'error');
    console.error(err);
  }
}

// Auto fetch from URL ?id=101
window.onload = function(){
  const urlParams = new URLSearchParams(window.location.search);
  const idParam = urlParams.get('id');
  if(idParam){
    fetchStudent(idParam);
  } else {
    Swal.fire('Error', 'ID missing in URL', 'error');
  }
}
</script>
</body>
</html>
