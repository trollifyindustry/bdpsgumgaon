<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Student Fee Submit</title>  <!-- SweetAlert2 -->  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>  <style>
    :root{
      --bg:#0b1220; --panel:#0f172a; --muted:#9fb39f; --text:#e8ffe8; --accent:#7efc7e; --line:#1f2a3a;
    }
    *{ box-sizing:border-box }
    body{ margin:0; min-height:100vh; display:grid; place-items:center; background:linear-gradient(180deg,#0a101a,#0b1220 40%, #060b12); color:var(--text); font-family:system-ui, Arial, sans-serif; padding:24px }
    .card{ width:min(880px,100%); background:var(--panel); border:1px solid var(--line); border-radius:16px; padding:22px; box-shadow:0 12px 40px rgba(0,0,0,.45) }
    h2{ margin:0 0 14px; text-align:center; color:var(--accent); letter-spacing:.3px }
    p.hint{ margin:0 0 18px; text-align:center; color:var(--muted); font-size:.95rem }

    form{ display:grid; gap:14px }
    .row{ display:grid; grid-template-columns:repeat(2,1fr); gap:14px }
    label{ font-size:.85rem; color:#cfead0; margin-bottom:6px; display:block }
    input, select, textarea{
      width:100%; padding:11px 12px; border-radius:10px; border:1px solid var(--line);
      background:#071018; color:var(--text); outline:none; font-size:15px;
    }
    textarea{ min-height:92px; resize:vertical }

    .actions{ display:flex; gap:12px; justify-content:center; margin-top:6px }
    button{ padding:10px 16px; border-radius:12px; border:1px solid transparent; cursor:pointer; font-weight:700 }
    .btn-submit{ background:var(--accent); color:#021; box-shadow:0 6px 18px rgba(126,252,126,.25) }
    .btn-cancel{ background:transparent; color:var(--accent); border-color:#213243 }

    @media (max-width:720px){ .row{ grid-template-columns:1fr } }

    /* Print: keep it clean */
    @media print{ body{ background:#fff } .card{ border:1px solid #ccc; box-shadow:none } }
  </style></head>
<body>
  <div class="card">
    <h2>Student Fee (2025‒26)</h2>
    <p class="hint">Fill details below and submit. Data will be saved to <b>Batabase</b> via your Web App.</p><form id="feeForm">
  <div class="row">
    <div>
      <label for="scholarNo">Scholar Number</label>
      <input id="scholarNo" name="scholarNo" type="text" placeholder="e.g., 101" readonly />
    </div>
    <div>
      <label for="amount">Amount (₹)</label>
      <input id="amount" name="amount" type="number" min="0" step="1" placeholder="Enter amount" required />
    </div>
  </div>

  <div class="row">
    <div>
      <label for="paymentDate">Payment Date</label>
      <input id="paymentDate" name="paymentDate" type="date" required />
    </div>
    <div>
      <label for="payerName">Payer Name</label>
      <input id="payerName" name="payerName" type="text" placeholder="Payer full name" required />
    </div>
  </div>

  <div class="row">
    <div>
      <label for="paymentMode">Payment Mode</label>
      <select id="paymentMode" name="paymentMode" required>
        <option value="">-- Select Mode --</option>
        <option>UPI</option>
        <option>Bank</option>
        <option>Cash</option>
        <option>PhonePe</option>
        <option>Google Pay</option>
        <option>Paytm</option>
      </select>
    </div>
    <div>
      <label for="receivedBy">Received By</label>
      <select id="receivedBy" name="receivedBy" required>
        <option value="">-- Select Receiver --</option>
        <option>Vandana Sulakhiya</option>
        <option>Varsha Sulakhiya</option>
      </select>
    </div>
  </div>

  <div>
    <label for="remarks">Remarks (optional)</label>
    <textarea id="remarks" name="remarks" placeholder="Any note..."></textarea>
  </div>

  <div class="actions">
    <button type="submit" class="btn-submit">Submit</button>
    <button type="button" class="btn-cancel" id="resetBtn">Reset</button>
  </div>
</form>

  </div>  <script>
    // === Set your deployed Apps Script Web App URL here ===
    const API_URL = "https://script.google.com/macros/s/AKfycbzu_QhgDf0X8zTuOir_t55GguGu3qrXp-i6i9ONONztrFmXs5arKyEnZ7DTmBYjRxSL/exec";

    // Prefill scholar from URL (?scholar=...) and set today's date
    (function init(){
      const url = new URL(window.location.href);
      const pre = url.searchParams.get('scholar') || url.searchParams.get('scholarNo') || '';
      if(pre) document.getElementById('scholarNo').value = pre;
      const d = new Date();
      const mm = String(d.getMonth()+1).padStart(2,'0');
      const dd = String(d.getDate()).padStart(2,'0');
      document.getElementById('paymentDate').value = `${d.getFullYear()}-${mm}-${dd}`;
    })();

    document.getElementById('resetBtn').addEventListener('click', ()=>{
      document.getElementById('feeForm').reset();
    });

    document.getElementById('feeForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const scholar = document.getElementById('scholarNo').value.trim();
      const amount = document.getElementById('amount').value.trim();
      const paymentDate = document.getElementById('paymentDate').value;
      const payerName = document.getElementById('payerName').value.trim();
      const paymentMode = document.getElementById('paymentMode').value;
      const receivedBy = document.getElementById('receivedBy').value;
      const remarks = document.getElementById('remarks').value.trim();

      // Basic validation
      if(!scholar || !amount || Number(amount)<=0 || !paymentDate || !payerName || !paymentMode || !receivedBy){
        Swal.fire('Missing info', 'Please fill all required fields with valid values.', 'warning');
        return;
      }

      const payload = { 
        scholar: scholar,
        amount: amount,
        paymentDate: paymentDate,
        payerName: payerName,
        paymentMode: paymentMode,
        receivedBy: receivedBy,
        remarks: remarks
      };

      // Confirm
      const ok = await Swal.fire({
        title: 'Confirm payment?',
        html: `Scholar: <b>${scholar}</b><br>Amount: <b>₹${amount}</b>`,
        icon: 'question', showCancelButton:true, confirmButtonText:'Submit'
      });
      if(!ok.isConfirmed) return;

      // Sending
      Swal.fire({ title:'Submitting...', text:'Please wait', allowOutsideClick:false, didOpen:()=>Swal.showLoading() });

      try{
        // NOTE: If you face CORS on GitHub Pages, switch to the no-cors block below.
        const res = await fetch(API_URL, {
          method:'POST',
          headers:{ 'Content-Type':'application/json' },
          body: JSON.stringify(payload)
        });

        // If Apps Script returns JSON
        let data;
        try{ data = await res.json(); } catch{ data = { status: res.ok ? 'ok' : 'error' }; }

        Swal.close();
        if(data.status === 'ok'){
          Swal.fire('Success', 'Saved successfully.', 'success');
          document.getElementById('feeForm').reset();
        }else{
          Swal.fire('Error', (data && data.message) || 'Server error', 'error');
        }
      }catch(err){
        // === Fallback for strict CORS ===
        try{
          await fetch(API_URL, {
            method:'POST',
            mode:'no-cors', // opaque response but will save on server
            headers:{ 'Content-Type':'application/json' },
            body: JSON.stringify(payload)
          });
          Swal.close();
          Swal.fire('Submitted', 'Saved (no-cors mode). Please verify in sheet.', 'success');
          document.getElementById('feeForm').reset();
        }catch(e){
          Swal.close();
          console.error(err);
          Swal.fire('Network or CORS error', 'Please check Web App deployment & permissions.', 'error');
        }
      }
    });
  </script></body>
</html>

<!----- code gs  jaha se scholar a rha hai bahi baka web url lagega 

google drive ke folder me Appacript file bnaa ke baha ye code ko depliy karke is code me link karna hota hai


function doPost(e) {
  try {
    // === Parse JSON body ===
    var data = JSON.parse(e.postData.contents);

    // === Open target Sheet by ID and get Sheet2 ===
    var sheet = SpreadsheetApp.openById("1T0WVNXsb4CW58CeGjR_Ce_r_8L4zAE1IW3JaCh9gM1E")
                              .getSheetByName("Sheet2");

    // === Append row in correct column order ===
    sheet.appendRow([
      data.scholar,       // A → Scholar No
      data.amount,        // B → Amount
      data.paymentDate,   // C → Payment Date
      data.payerName,     // D → Payer Name
      data.paymentMode,   // E → Payment Mode
      data.receivedBy,    // F → Received By
      data.remarks        // G → Remarks
    ]);

    // === Success Response ===
    return ContentService.createTextOutput(
      JSON.stringify({ status: "ok", message: "Saved successfully" })
    ).setMimeType(ContentService.MimeType.JSON);

  } catch (err) {
    // === Error Handling ===
    return ContentService.createTextOutput(
      JSON.stringify({ status: "error", message: err.message })
    ).setMimeType(ContentService.MimeType.JSON);
  }
}
--->
